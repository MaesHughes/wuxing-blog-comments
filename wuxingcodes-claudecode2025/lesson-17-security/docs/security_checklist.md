# 安全检查清单 v1.0

> ClaudeCode 安全攻防实战 - 部署前必检项目（错过一条都可能凉凉！）

## 📋 检查清单概览

这清单是我被黑后哭了一晚上整理出来的...每一条都是用真金白银的教训换来的。别嫌烦，一条都不能漏！

---

## 🔐 1. 认证与授权

### 1.1 密钥管理
- [ ] **禁止硬编码密钥** - 所有密钥必须从环境变量或密钥管理系统读取
- [ ] **密钥强度检查** - 所有密钥长度至少32字节，包含大小写字母、数字和特殊字符
- [ ] **密钥轮换计划** - 建立定期密钥轮换机制（建议90天）
- [ ] **密钥存储安全** - 使用专用的密钥管理服务（如Vault、AWS KMS）

### 1.2 JWT配置
- [ ] **Token过期时间** - Access Token ≤ 30分钟，Refresh Token ≤ 7天
- [ ] **Token黑名单** - 实现Token撤销机制
- [ ] **设备指纹** - 验证请求来源设备
- [ ] **刷新Token限制** - 限制每个用户的活跃Token数量（建议≤5个）

### 1.3 权限控制
- [ ] **RBAC实现** - 基于角色的访问控制
- [ ] **最小权限原则** - 每个角色只赋予必要权限
- [ ] **权限审计** - 定期审查用户权限
- [ ] **特权账号管理** - 严格限制管理员账号数量

---

## 🛡️ 2. 数据保护

### 2.1 加密配置
- [ ] **传输加密** - 所有API必须使用HTTPS/TLS 1.3
- [ ] **存储加密** - 敏感数据字段级加密（AES-256）
- [ ] **密钥分离** - 加密密钥与数据分离存储
- [ ] **加密算法** - 使用经过验证的加密算法（AES、ChaCha20）

### 2.2 敏感数据处理
- [ ] **字段识别** - 自动识别并加密敏感字段
- [ ] **数据脱敏** - 日志中敏感数据脱敏处理
- [ ] **数据生命周期** - 建立数据保留和销毁策略
- [ ] **备份加密** - 数据备份必须加密

### 2.3 数据库安全
- [ ] **连接加密** - 数据库连接使用SSL/TLS
- [ ] **访问控制** - 数据库用户权限最小化
- [ ] **SQL注入防护** - 使用参数化查询
- [ ] **审计日志** - 启用数据库审计功能

---

## 🚪 3. 输入验证与防护

### 3.1 输入验证
- [ ] **白名单验证** - 对所有输入使用白名单验证
- [ ] **长度限制** - 限制所有输入字段的长度
- [ ] **格式检查** - 验证输入格式（邮箱、电话等）
- [ ] **特殊字符过滤** - 过滤或转义特殊字符

### 3.2 XSS防护
- [ ] **输出编码** - 所有用户输出进行HTML编码
- [ ] **CSP策略** - 实施内容安全策略
- [ ] **HttpOnly Cookie** - 设置Cookie为HttpOnly
- [ ] **XSS过滤器** - 使用专业的XSS防护库

### 3.3 CSRF防护
- [ ] **CSRF Token** - 实施CSRF令牌验证
- [ ] **SameSite Cookie** - 设置Cookie的SameSite属性
- [ ] **Referer检查** - 验证请求来源
- [ ] **双重提交Cookie** - 实施双重Cookie提交模式

### 3.4 文件上传安全
- [ ] **文件类型检查** - 严格限制允许的文件类型
- [ ] **文件大小限制** - 限制上传文件大小
- [ ] **病毒扫描** - 对上传文件进行病毒扫描
- [ ] **存储隔离** - 上传文件存储在隔离区域

---

## 👁️ 4. 监控与日志

### 4.1 日志配置
- [ ] **安全事件日志** - 记录所有安全相关事件
- [ ] **日志分级** - 实施日志分级管理
- [ ] **日志完整性** - 确保日志不被篡改
- [ ] **日志轮转** - 配置日志轮转和归档

### 4.2 监控指标
- [ ] **性能监控** - CPU、内存、磁盘、网络监控
- [ ] **业务监控** - API调用频率、错误率监控
- [ ] **安全监控** - 失败登录、异常访问监控
- [ ] **实时告警** - 配置关键指标的实时告警

### 4.3 异常检测
- [ ] **行为分析** - 检测异常用户行为
- [ ] **异常IP** - 识别和阻止恶意IP
- [ ] **暴力破解** - 检测并阻止暴力破解
- [ ] **异常流量** - 识别DDoS攻击

---

## ⚡ 5. 性能与可用性

### 5.1 限流配置
- [ ] **API限流** - 实施API调用频率限制
- [ ] **登录限流** - 限制登录尝试次数
- [ ] **IP限流** - 基于IP的限流策略
- [ ] **用户限流** - 基于用户的限流策略

### 5.2 熔断机制
- [ ] **熔断配置** - 配置服务熔断参数
- [ ] **降级策略** - 准备服务降级方案
- [ ] **健康检查** - 实施服务健康检查
- [ ] **超时设置** - 设置合理的超时时间

### 5.3 缓存策略
- [ ] **缓存安全** - 敏感数据不缓存
- [ ] **缓存加密** - 必要时对缓存内容加密
- [ ] **缓存失效** - 数据变更时及时更新缓存
- [ ] **CDN配置** - 使用CDN加速静态资源

---

## 🚨 6. 应急响应

### 6.1 应急预案
- [ ] **事件分级** - 建立安全事件分级标准
- [ ] **响应流程** - 制定详细的响应流程
- [ ] **联系人清单** - 维护应急联系人列表
- [ ] **演练计划** - 定期进行应急演练

### 6.2 数据备份
- [ ] **自动备份** - 配置自动数据备份
- [ ] **异地备份** - 备份数据异地存储
- [ ] **备份验证** - 定期验证备份可用性
- [ ] **恢复测试** - 定期测试数据恢复

### 6.3 数字取证
- [ ] **证据保全** - 建立数字证据保全流程
- [ ] **日志保留** - 安全日志长期保留
- [ ] **取证工具** - 准备必要的取证工具
- [ ] **法律合规** - 了解相关法律法规

---

## 🔧 7. 基础设施安全

### 7.1 网络安全
- [ ] **防火墙配置** - 配置严格的防火墙规则
- [ ] **网络隔离** - 实施网络分段隔离
- [ ] **VPN访问** - 管理员使用VPN访问
- [ ] **端口管理** - 关闭不必要的端口

### 7.2 服务器安全
- [ ] **系统加固** - 操作系统安全加固
- [ ] **补丁管理** - 及时更新安全补丁
- [ ] **访问控制** - 限制服务器访问权限
- [ ] **入侵检测** - 部署入侵检测系统

### 7.3 容器安全
- [ ] **镜像安全** - 使用安全的基础镜像
- [ ] **权限控制** - 容器运行使用非root用户
- [ ] **资源限制** - 设置容器资源限制
- [ ] **网络策略** - 配置Kubernetes网络策略

---

## ✅ 8. 部署前最终检查

### 8.1 配置审查
- [ ] **环境变量检查** - 确认所有必要的环境变量已设置
- [ ] **默认密码更改** - 更改所有默认密码
- [ ] **调试模式关闭** - 生产环境关闭调试模式
- [ ] **错误信息** - 避免暴露敏感的错误信息

### 8.2 测试验证
- [ ] **渗透测试** - 进行专业的渗透测试
- [ ] **代码审计** - 完成代码安全审计
- [ ] **压力测试** - 进行系统压力测试
- [ ] **安全扫描** - 运行自动化安全扫描

### 8.3 文档准备
- [ ] **部署文档** - 准备详细的部署文档
- [ ] **运维手册** - 编写系统运维手册
- [ ] **应急手册** - 准备应急响应手册
- [ ] **联系方式** - 记录技术支持联系方式

---

## 📊 安全评分

### 评分标准
- **0-60分**：存在严重安全风险，不建议部署
- **61-80分**：存在安全风险，需要改进后部署
- **81-95分**：安全状况良好，可以部署
- **96-100分**：安全状况优秀，推荐部署

### 计算方法
每项检查通过得1分，总分100分。重点关注"必须"项（标有**），这些项目不合格将导致严重安全风险。

---

## 🔄 持续改进

### 定期审查
- [ ] **月度安全会议** - 每月召开安全会议
- [ ] **季度安全评估** - 每季度进行全面安全评估
- [ ] **年度渗透测试** - 每年进行渗透测试
- [ ] **持续学习** - 持续关注新的安全威胁

### 更新维护
- [ ] **威胁情报** - 订阅安全威胁情报
- [ ] **漏洞通报** - 关注安全漏洞通报
- [ ] **安全培训** - 定期进行安全培训
- [ ] **流程优化** - 持续优化安全流程

---

## 📞 紧急联系方式

| 角色 | 联系人 | 电话 | 邮箱 |
|------|--------|------|------|
| 安全负责人 | [待填写] | [待填写] | [待填写] |
| 技术负责人 | [待填写] | [待填写] | [待填写] |
| 运维负责人 | [待填写] | [待填写] | [待填写] |
| 法务顾问 | [待填写] | [待填写] | [待填写] |

---

> **重要提醒**：安全是一个持续的过程，不是一次性任务。请定期回顾和更新此清单。

> **版本历史**：
> - v1.0 (2025-01-11): 初始版本，基于第17课内容整理

> **作者**：大熊掌门
> **最后更新**：2025-01-11